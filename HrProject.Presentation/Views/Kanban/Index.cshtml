@using HrProject.Domain.Entities
@model List<Tasks>
<link rel="stylesheet" href="~/calendarScript/plugins/fullcalendar/main.css">
<link rel="stylesheet" href="~/calendarScript/plugins/fontawesome-free/css/all.min.css">
<!-- fullCalendar -->
<link rel="stylesheet" href="~/calendarScript/plugins/fullcalendar/main.css">
<!-- Theme style -->
<link rel="stylesheet" href="~/calendarScript/dist/css/adminlte.min.css">
<script src="~/calendarScript/plugins/jquery/jquery.min.js"></script>
<!-- Bootstrap -->
<script src="~/calendarScript/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
<!-- jQuery UI -->
<script src="~/calendarScript/plugins/jquery-ui/jquery-ui.min.js"></script>
<!-- AdminLTE App -->
<script src="~/calendarScript/dist/js/adminlte.min.js"></script>

<script src="https://code.jquery.com/ui/1.13.1/jquery-ui.min.js"></script>
<link href="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote-bs4.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote-bs4.min.js"></script>

<!-- jQuery UI CSS -->
<link rel="stylesheet" href="https://code.jquery.com/ui/1.13.1/themes/base/jquery-ui.css">

<style>
    .profile-picture {
        width: 30px; /* Adjust the size of the circular frame */
        height: 30px; /* Adjust the size of the circular frame */
        border-radius: 50%; /* Makes the frame circular */
        overflow: hidden; /* Hides overflow content */
        box-shadow: 0px 0px 5px rgba(0, 0, 0, 0.3); /* Optional: Adds shadow effect */
    }

        .profile-picture img {
            width: 100%;
            height: 100%;
            object-fit: cover; /* Ensures the image fills the circular frame */
        }

</style>
<div class="content-wrapper kanban" style="margin-left:-1px;">
    <section class="content-header">
        <div class="container-fluid">
            <div class="row">
                <div class="col-sm-6">
                    <h1>Yazılım İstek Kanban Board</h1>
                    <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#staticBackdrop"><i class="fas fa-play"></i> ERP Sorun bildir</button>
                </div>
            </div>
        </div>
    </section>

    <section class="content pb-3">
        <div class="container-fluid h-100">
            <div class="card card-row card-secondary">
                <div class="card-header">
                    <h3 class="">
                        Yapılacaklar
                    </h3>
                </div>
                <div class="card-body" data-status="None">
                    @foreach (var item in Model.Where(x => x.Status == Status.None))
                    {
                        <div data-taskid="@item.Id" class="card hareketli card-@GetUrgencyColor(item.Urgency)">
                            <div class="card-header">
                                <h6 class="text-white">@item.Title</h6>
                                <div class="card-tools">
                                    <span class="badge bg-@GetUrgencyColor(item.Urgency)">@item.Urgency.ToString()</span>
                                    <span class="badge bg-info">@item.StartTime.ToString("dd/MM/yyyy")</span>
                                    <a href="#" class="btn btn-tool btn-link">ID: @item.Id</a>
                                    <a href="#" class="btn btn-tool"><i class="fas fa-pen"></i></a>
                                    <button type="button" class="btn btn-tool delete-task-btn" data-task-id="@item.Id"><i class="fas fa-trash"></i></button>
                                </div>
                            </div>
                            <div class="">
                                <p>@item.Description</p>
                                <hr />
                                <div class="row">
                                    <div class="col-12 col-md-8">
                                        <div class="icon-container">
                                            <a class="icon"><i class="fas fa-paperclip"></i></a>
                                            <button type="button" data-id="@item.Id" class="btn-primary icon message"><i class="fas fa-envelope"></i></button>
                                            <a class="icon"><i class="fas fa-info-circle"></i></a>
                                        </div>
                                    </div>
                                    <div class="col-12 col-md-4 d-flex align-items-end justify-content-end">
                                        <div class="profile-picture">
                                            <img alt="@item.ResponseUser?.Name" src="~/ProfilPhoto/@item.ResponseUser?.ProfilPhoto" />
                                            <p class="open-user-name">@item.ResponseUser?.Name @item.ResponseUser?.SurName</p>

                                        </div>
                                        <div class="profile-picture">
                                            <img alt="@item.OpenUser?.Name" src="~/ProfilPhoto/@item.OpenUser?.ProfilPhoto" />
                                            <p class="open-user-name">@item.OpenUser?.Name @item.OpenUser?.SurName</p>

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    }
                </div>


            </div>
            <div class="card card-row card-primary">
                <div class="card-header">
                    <h3 class="card-title">
                        Yapılıyor
                    </h3>
                </div>
                <div class="card-body" data-status="Todo">
                    @foreach (var item in Model.Where(x => x.Status == Status.Todo))
                    {
                        <div data-taskid="@item.Id" class="card hareketli card-@GetUrgencyColor(item.Urgency)">
                            <div class="card-header">
                                <h6 class="text-white">@item.Title</h6>
                                <div class="card-tools">
                                    <span class="badge bg-@GetUrgencyColor(item.Urgency)">@item.Urgency.ToString()</span>
                                    <span class="badge bg-info">@item.StartTime.ToString("dd/MM/yyyy")</span>
                                    <a href="#" class="btn btn-tool btn-link">ID: @item.Id</a>
                                    <a href="#" class="btn btn-tool"><i class="fas fa-pen"></i></a>
                                    <button type="button" class="btn btn-tool delete-task-btn" data-task-id="@item.Id"><i class="fas fa-trash"></i></button>
                                </div>
                            </div>
                            <div class="card-body">
                                <p>@item.Description</p>
                                <hr />
                                <div class="row">
                                    <div class="col-12 col-md-8">
                                        <div class="icon-container">
                                            <a class="icon"><i class="fas fa-paperclip"></i></a>
                                            <button type="button" data-id="@item.Id" class="icon message"><i class="fas fa-envelope"></i></button>
                                            <a class="icon"><i class="fas fa-info-circle"></i></a>
                                        </div>
                                    </div>
                                    <div class="col-12 col-md-4 d-flex align-items-end justify-content-end">
                                        <div class="profile-picture">
                                            <img alt="@item.ResponseUser?.Name" src="~/ProfilPhoto/@item.ResponseUser?.ProfilPhoto" />
                                            <p class="open-user-name">@item.ResponseUser?.Name @item.ResponseUser?.SurName</p>

                                        </div>
                                        <div class="profile-picture">
                                            <img alt="@item.OpenUser?.Name" src="~/ProfilPhoto/@item.OpenUser?.ProfilPhoto" />
                                            <p class="open-user-name">@item.OpenUser?.Name @item.OpenUser?.SurName</p>

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    }
                </div>
            </div>
            <div class="card card-row card-default">
                <div class="card-header bg-info">
                    <h3 class="card-title">
                        Test Ediliyor
                    </h3>
                </div>
                <div class="card-body" data-status="InProgress">
                    @foreach (var item in Model.Where(x => x.Status == Status.InProgress))
                    {
                        <div data-taskid="@item.Id" class="card hareketli card-@GetUrgencyColor(item.Urgency)">
                            <div class="card-header">
                                <h6 class="text-white">@item.Title</h6>
                                <div class="card-tools">
                                    <span class="badge bg-@GetUrgencyColor(item.Urgency)">@item.Urgency.ToString()</span>
                                    <span class="badge bg-info">@item.StartTime.ToString("dd/MM/yyyy")</span>
                                    <a href="#" class="btn btn-tool btn-link">ID: @item.Id</a>
                                    <a href="#" class="btn btn-tool"><i class="fas fa-pen"></i></a>
                                    <button type="button" class="btn btn-tool delete-task-btn" data-task-id="@item.Id"><i class="fas fa-trash"></i></button>
                                </div>
                            </div>
                            <div class="">
                                <p>@item.Description</p>
                                <hr />
                                <div class="row">
                                    <div class="col-12 col-md-8">
                                        <div class="icon-container">
                                            <a class="icon"><i class="fas fa-paperclip"></i></a>
                                            <button type="button" data-id="@item.Id" class="icon message"><i class="fas fa-envelope"></i></button>
                                            <a class="icon"><i class="fas fa-info-circle"></i></a>
                                        </div>
                                    </div>
                                    <div class="col-12 col-md-4 d-flex align-items-end justify-content-end">
                                        <div class="profile-picture">
                                            <img alt="@item.ResponseUser?.Name" src="~/ProfilPhoto/@item.ResponseUser?.ProfilPhoto" />
                                            <p class="open-user-name">@item.ResponseUser?.Name @item.ResponseUser?.SurName</p>

                                        </div>
                                        <div class="profile-picture">
                                            <img alt="@item.OpenUser?.Name" src="~/ProfilPhoto/@item.OpenUser?.ProfilPhoto" />
                                            <p class="open-user-name">@item.OpenUser?.Name @item.OpenUser?.SurName</p>

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    }
                </div>
            </div>
            <div class="card card-row card-success">
                <div class="card-header">
                    <h3 class="card-title">
                        Kapandı
                    </h3>
                </div>
                <div class="card-body" data-status="Done">
                    @foreach (var item in Model.Where(x => x.Status == Status.Done))
                    {
                        <div class="card hareketli card-@GetUrgencyColor(item.Urgency)">
                            <div class="card-header">
                                <h6 class="text-white">@item.Title</h6>
                                <div class="card-tools">
                                    <span class="badge bg-@GetUrgencyColor(item.Urgency)">@item.Urgency.ToString()</span>
                                    <span class="badge bg-info">@item.StartTime.ToString("dd/MM/yyyy")</span>
                                    <a href="#" class="btn btn-tool btn-link">ID: @item.Id</a>
                                    <a href="#" class="btn btn-tool"><i class="fas fa-pen"></i></a>
                                    <button type="button" class="btn btn-tool delete-task-btn" data-task-id="@item.Id"><i class="fas fa-trash"></i></button>
                                </div>
                            </div>
                            <div class="">
                                <p>@item.Description</p>
                                <hr />
                                <div class="row">
                                    <div class="col-12 col-md-8">
                                        <div class="icon-container">
                                            <a class="icon"><i class="fas fa-paperclip"></i></a>
                                            <a class="icon"><i class="fas fa-envelope"></i></a>
                                            <a class="icon"><i class="fas fa-info-circle"></i></a>
                                        </div>
                                    </div>
                                    <div class="col-12 col-md-4 d-flex align-items-end justify-content-end">
                                        <div class="profile-picture">
                                            <img alt="@item.ResponseUser?.Name" src="~/ProfilPhoto/@item.ResponseUser?.ProfilPhoto" />
                                            <p class="open-user-name">@item.ResponseUser?.Name @item.ResponseUser?.SurName</p>

                                        </div>
                                        <div class="profile-picture">
                                            <img alt="@item.OpenUser?.Name" src="~/ProfilPhoto/@item.OpenUser?.ProfilPhoto" />
                                            <p class="open-user-name">@item.OpenUser?.Name @item.OpenUser?.SurName</p>

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    }
                </div>
            </div>
        </div>
    </section>
</div>
<div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="staticBackdropLabel">Toplu Görev Başlatma</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="mb-3">
                    <label for="taskTitle" class="form-label">Başlık</label>
                    <input type="text" class="form-control" id="taskTitle" name="title" required>
                </div>
                <div class="mb-3">
                    <label for="taskDescription" class="form-label">Açıklama</label>
                    <textarea class="form-control" id="taskDescription" name="description" required></textarea>
                </div>
                <div class="mb-3">
                    <label for="taskDetayliAciklama" class="form-label">Detaylı Açıklama</label>
                    <textarea class="form-control" id="taskDetayliAciklama" name="detayliAciklama"></textarea>
                </div>
                <div class="mb-3">
                    <label for="taskStartTime" class="form-label">Başlangıç Zamanı</label>
                    <input type="datetime-local" class="form-control" id="taskStartTime" name="startTime" required>
                </div>
                <div class="mb-3">
                    <label for="taskEndTime" class="form-label">Bitiş Zamanı</label>
                    <input type="datetime-local" class="form-control" id="taskEndTime" name="endTime">
                </div>
                <div class="mb-3">
                    <label for="taskUrgency" class="form-label">Aciliyet</label>
                    <select class="form-select" id="taskUrgency" name="urgency" required>
                        <option value="">Seçiniz...</option>
                        <option value="0">Düşük</option>
                        <option value="1">Orta</option>
                        <option value="2">Acil</option>
                    </select>
                </div>

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Kapat</button>
                <button type="button" id="GorevEkle" class="btn btn-primary">Görevi Ekle</button>
            </div>
        </div>
    </div>
</div>
<!-- Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Mesaj</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body" id="modalContent">
                <!-- Partial view içeriği buraya yüklenecek -->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Kapat</button>
            </div>
        </div>
    </div>
</div>


<script src="~/js/tasks/index.js"></script>
@functions {
    string GetUrgencyColor(Urgency urgency)
    {
        switch (urgency)
        {
            case Urgency.Low:
                return "success";
            case Urgency.Medium:
                return "warning";
            case Urgency.High:
                return "danger";
            default:
                return "secondary";
        }
    }
}